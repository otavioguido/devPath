version: "3.7"

services:

  mysqldb:
    image: mysql:latest
    ports:
      - "3306:3306"
    environment:
      - MYSQL_ROOT_PASSWORD=password
      - MYSQL_DATABASE=chat_db
      - MYSQL_USER=devpath
      - MYSQL_PASSWORD=password
    container_name: mysqldb-container

  appdb:
    build:
      context: ./dataBase
    image: chat-data-base-image
    ports:
    - "8089:8089"
    container_name: chat-data-base-container
    entrypoint: ["java", "-jar", "dataBase.jar"]
    environment:
      - DBHOST=mysqldb
      - spring.datasource.url=jdbc:mysql://mysqldb-container:3306/chat_db
      - spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
      - spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
      - spring.datasource.username=devpath
        spring.datasource.password=password
    depends_on:
      - mysqldb
    links:
      - "mysqldb:mysql"
      - "mysqldb:mysqldb-container"


